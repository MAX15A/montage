<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>出張取り付け｜ナビ・ドラレコ・電装のプロがご自宅で施工</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="高級外車から国産車まで、ナビ・ドラレコ・セキュリティ・ライト・車中泊電装の出張取り付け。純正風の美しい仕上げと施工保証。最短当日。">
  <meta name="theme-color" content="#0f172a">
  <style>
    :root {
      --bg: #0f172a; --surface: #111827; --card: #1f2937; --text: #e5e7eb; --muted: #9ca3af;
      --accent: #3b82f6; --accent2: #ef4444; --success: #22c55e; --warning: #f59e0b;
      --shadow: 0 10px 30px rgba(0,0,0,0.35); --radius: 14px; --radius-sm: 10px; --radius-lg: 22px; --maxw: 1120px;
    }
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; background: var(--bg); color: var(--text); }
    body { font-family: system-ui, -apple-system, "Segoe UI", "Noto Sans JP", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif; line-height: 1.6; -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }
    .container { width: 100%; max-width: var(--maxw); margin: 0 auto; padding: 0 20px; }
    header { position: sticky; top: 0; z-index: 100; background: rgba(17,24,39,0.85); backdrop-filter: blur(8px); border-bottom: 1px solid rgba(255,255,255,0.06); }
    .nav { display: flex; align-items: center; justify-content: space-between; padding: 14px 20px; }
    .brand { display: flex; align-items: center; gap: 12px; font-weight: 700; letter-spacing: 0.2px; }
    .brand .logo { width: 36px; height: 36px; display: grid; place-items: center; background: linear-gradient(135deg, #2563eb, #3b82f6); color: white; border-radius: 8px; box-shadow: var(--shadow); font-weight: 800; }
    nav ul { list-style: none; display: none; gap: 20px; margin: 0; padding: 0; }
    .cta { display: flex; gap: 10px; align-items: center; }
    .btn { display: inline-flex; align-items: center; justify-content: center; gap: 8px; padding: 10px 16px; border-radius: 999px; border: 1px solid rgba(255,255,255,0.12); background: rgba(255,255,255,0.04); color: var(--text); cursor: pointer; transition: transform 0.12s ease, background 0.2s ease, border-color 0.2s ease; }
    .btn:hover { transform: translateY(-1px); background: rgba(255,255,255,0.08); }
    .btn.primary { background: linear-gradient(135deg, #2563eb, #3b82f6); border: none; color: #fff; font-weight: 700; box-shadow: 0 8px 20px rgba(37,99,235,0.35); }
    .btn.primary:hover { transform: translateY(-1px) scale(1.01); }
    .btn.ghost { background: transparent; border-color: rgba(255,255,255,0.18); }
    .btn.small { padding: 8px 12px; }
    .hero { padding: 48px 0 24px; background: radial-gradient(1200px 600px at 20% -20%, rgba(59,130,246,0.18), transparent), radial-gradient(900px 500px at 100% 0%, rgba(239,68,68,0.18), transparent); }
    .hero-inner { display: grid; grid-template-columns: 1.15fr 0.85fr; gap: 28px; align-items: center; }
    .tag { display: inline-flex; align-items: center; gap: 8px; padding: 6px 12px; border-radius: 999px; font-size: 13px; color: #cbd5e1; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.08); }
    h1 { font-size: clamp(28px, 4.6vw, 48px); margin: 14px 0; line-height: 1.2; letter-spacing: 0.2px; }
    .sub { color: var(--muted); font-size: 16px; margin-bottom: 18px; }
    .hero-ctas { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 10px; }
    .badges { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 18px; }
    .badge { display: inline-flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.06); color: #cbd5e1; border: 1px solid rgba(255,255,255,0.08); border-radius: 999px; padding: 8px 12px; font-size: 13px; }
    .hero-media { background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); border: 1px solid rgba(255,255,255,0.08); border-radius: var(--radius-lg); min-height: 280px; position: relative; overflow: hidden; box-shadow: var(--shadow); }
    .hero-media::after { content: ""; position: absolute; inset: 0; background-image: radial-gradient(60px 60px at 20% 30%, rgba(59,130,246,0.25), transparent), radial-gradient(80px 80px at 70% 60%, rgba(239,68,68,0.25), transparent); mix-blend-mode: screen; }
    .hero-media .photo { position: absolute; inset: 10px; border-radius: var(--radius); border: 1px solid rgba(255,255,255,0.08); background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="800"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="%230b1220"/><stop offset="100%" stop-color="%23141c2e"/></linearGradient></defs><rect width="100%" height="100%" fill="url(%23g)"/><g fill="%233b82f6" opacity="0.25"><circle cx="300" cy="220" r="160"/><circle cx="860" cy="540" r="200"/></g><g fill="%23ffffff" opacity="0.06"><rect x="60" y="60" width="1080" height="680" rx="14"/></g></svg>') center/cover no-repeat; }

    section { padding: 40px 0; }
    .section-head { display: flex; align-items: flex-end; justify-content: space-between; gap: 16px; margin-bottom: 16px; }
    .section-head h2 { font-size: clamp(22px, 3.4vw, 34px); margin: 0; }
    .section-head p { color: var(--muted); margin: 8px 0 0; }
    .grid { display: grid; gap: 16px; grid-template-columns: repeat(12, 1fr); }
    .col-4 { grid-column: span 4; }
    .col-6 { grid-column: span 6; }
    .col-12 { grid-column: span 12; }
    @media (max-width: 900px) { .hero-inner { grid-template-columns: 1fr; } .col-4 { grid-column: span 6; } .col-6 { grid-column: span 12; } }
    @media (max-width: 640px) { nav ul { display: none; } .col-4, .col-6 { grid-column: span 12; } }
    .card { background: var(--card); border: 1px solid rgba(255,255,255,0.08); border-radius: var(--radius); padding: 16px; position: relative; transition: transform 0.12s ease, box-shadow 0.2s ease, border-color 0.2s ease; }
    .card:hover { transform: translateY(-2px); box-shadow: var(--shadow); border-color: rgba(59,130,246,0.35); }
    .card h3 { margin: 8px 0 6px; font-size: 18px; }
    .card p { margin: 0; color: var(--muted); font-size: 14px; }
    .icon { width: 32px; height: 32px; display: grid; place-items: center; border-radius: 8px; background: rgba(59,130,246,0.15); color: var(--accent); border: 1px solid rgba(59,130,246,0.25); }

    .calc { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    @media (max-width: 900px) { .calc { grid-template-columns: 1fr; } }
    .input { display: flex; flex-direction: column; gap: 10px; }
    label { font-size: 14px; color: #cbd5e1; }
    input, select, textarea { padding: 12px 14px; background: #0b1220; color: var(--text); border: 1px solid rgba(255,255,255,0.1); border-radius: 10px; outline: none; transition: border-color 0.2s ease, box-shadow 0.2s ease; }
    input:focus, select:focus, textarea:focus { border-color: rgba(59,130,246,0.55); box-shadow: 0 0 0 4px rgba(59,130,246,0.15); }

    .price { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
    @media (max-width: 900px) { .price { grid-template-columns: 1fr; } }
    .price-card { background: var(--card); border: 1px solid rgba(255,255,255,0.08); border-radius: var(--radius); padding: 16px; }
    .price-title { font-weight: 700; margin-bottom: 8px; }
    .price-num { font-size: 26px; font-weight: 800; letter-spacing: 0.4px; }
    .price-note { color: var(--muted); font-size: 13px; }

    .wizard { background: var(--card); border: 1px solid rgba(255,255,255,0.08); border-radius: var(--radius-lg); padding: 16px; }
    .steps { display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px; margin-bottom: 14px; }
    .step-dot { height: 8px; border-radius: 999px; background: rgba(255,255,255,0.18); }
    .step-dot.active { background: var(--accent); }
    .wiz-pane { display: none; }
    .wiz-pane.active { display: block; }
    .wiz-actions { display: flex; justify-content: space-between; gap: 10px; margin-top: 12px; }
    .help { color: var(--muted); font-size: 13px; }
    footer { margin-top: 30px; padding: 24px 0; border-top: 1px solid rgba(255,255,255,0.08); color: var(--muted); position: relative; }

    /* スマホ固定ナビ */
    .mobile-nav { position: fixed; bottom: 12px; left: 50%; transform: translateX(-50%); background: rgba(17,24,39,0.85); backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,0.1); border-radius: 999px; display: flex; gap: 12px; padding: 8px 12px; z-index: 100; box-shadow: var(--shadow); }
    .mobile-nav .btn { padding: 8px 12px; }
    @media (min-width: 900px) { .mobile-nav { display: none; } }

    /* 管理者リンク（目立たない） */
    .admin-link { position: absolute; right: 8px; bottom: 8px; font-size: 12px; opacity: 0.28; color: #93a3b8; cursor: pointer; user-select: none; }
    .admin-link:hover { opacity: 0.42; text-decoration: none; }

    /* ログインモーダル（シンプル） */
    .modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.55); backdrop-filter: blur(3px); display: none; align-items: center; justify-content: center; z-index: 200; }
    .modal { width: 100%; max-width: 360px; background: var(--surface); border: 1px solid rgba(255,255,255,0.1); border-radius: 16px; padding: 16px; box-shadow: var(--shadow); }
    .modal h3 { margin: 0 0 8px; font-size: 18px; }
    .modal .row { display: grid; gap: 10px; }
    .modal-actions { display: flex; justify-content: flex-end; gap: 8px; margin-top: 10px; }
    .modal-small { font-size: 12px; color: var(--muted); margin-top: 6px; }
    .show { display: flex !important; }
  </style>

  <!-- 構造化データ（例：必要に応じて修正） -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "LocalBusiness",
    "name": "出張取り付けサービス",
    "image": "https://example.com/og.jpg",
    "url": "https://example.com",
    "telephone": "000-000-0000",
    "priceRange": "¥¥",
    "areaServed": "関東一円",
    "address": { "@type": "PostalAddress", "addressCountry": "JP", "addressRegion": "東京都", "addressLocality": "〇〇区", "postalCode": "000-0000", "streetAddress": "〇〇〇〇" },
    "openingHours": "Mo-Fr 09:00-19:00",
    "makesOffer": [
      { "@type": "Offer", "name": "ドラレコ取付（出張）", "priceCurrency": "JPY", "price": "12000" },
      { "@type": "Offer", "name": "ナビ取付（出張）", "priceCurrency": "JPY", "price": "28000" }
    ]
  }
  </script>
</head>
<body>

<header>
  <div class="nav container">
    <div class="brand">
      <div class="logo">🚗</div>
      <div>出張取り付け | 純正風の美しい施工</div>
    </div>
    <nav>
      <ul>
        <li><a href="#services">サービス</a></li>
        <li><a href="#area">エリア判定</a></li>
        <li><a href="#pricing">価格</a></li>
        <li><a href="#booking">予約</a></li>
        <li><a href="#faq">FAQ</a></li>
      </ul>
    </nav>
    <div class="cta">
      <a class="btn ghost" href="#area">エリア判定</a>
      <a class="btn primary" href="#booking">予約する</a>
    </div>
  </div>
</header>

<main>
  <!-- ヒーロー -->
  <section class="hero">
    <div class="container hero-inner">
      <div>
        <div class="tag">あなたの駐車場で、プロが純正風に取り付け。</div>
        <h1>高級外車も、国産車も。ナビ・ドラレコ・電装の出張施工。</h1>
        <p class="sub">熟練の電装技術と丁寧な養生。配線は保護・固定まで徹底、見えない品質に自信があります。最短当日、施工保証付き。</p>
        <div class="hero-ctas">
          <a class="btn primary" href="#booking">最短日程を確認</a>
          <a class="btn" href="#area">エリアと出張費を確認</a>
          <a class="btn" href="#services">メニューを見る</a>
        </div>
        <div class="badges">
          <div class="badge">輸入車コーディング対応</div>
          <div class="badge">雨天は簡易テントで施工</div>
          <div class="badge">電源不要（ポータブル電源持参）</div>
        </div>
      </div>
      <div class="hero-media"><div class="photo" aria-label="施工風景ダミー画像"></div></div>
    </div>
  </section>

  <!-- サービス一覧 -->
  <section id="services">
    <div class="container">
      <div class="section-head">
        <div><h2>出張サービス一覧</h2><p>目安工期と参考価格を表示。詳細はお見積りで確定します。</p></div>
        <a class="btn small" href="#booking">無料見積り</a>
      </div>
      <div class="grid">
        <div class="col-4"><div class="card"><div style="display:flex;align-items:center;gap:10px;"><div class="icon">🎥</div><h3>ドラレコ取付（前後・360°）</h3></div><p>目安90–120分｜参考 ¥12,000〜｜駐車監視ハード配線対応</p></div></div>
        <div class="col-4"><div class="card"><div style="display:flex;align-items:center;gap:10px;"><div class="icon">🧭</div><h3>カーナビ取付</h3></div><p>目安180–240分｜参考 ¥28,000〜｜輸入車フェイス加工可</p></div></div>
        <div class="col-4"><div class="card"><div style="display:flex;align-items:center;gap:10px;"><div class="icon">🔊</div><h3>オーディオ・スピーカー</h3></div><p>目安120–240分｜参考 ¥18,000〜｜DSP・デッドニング対応</p></div></div>
        <div class="col-4"><div class="card"><div style="display:flex;align-items:center;gap:10px;"><div class="icon">🔐</div><h3>セキュリティ・トラッカー</h3></div><p>目安120–180分｜参考 ¥22,000〜｜イモビ・GPS対応</p></div></div>
        <div class="col-4"><div class="card"><div style="display:flex;align-items:center;gap:10px;"><div class="icon">💡</div><h3>ライト・LED・センサー</h3></div><p>目安60–120分｜参考 ¥9,000〜｜車検適合配光で施工</p></div></div>
        <div class="col-4"><div class="card"><div style="display:flex;align-items:center;gap:10px;"><div class="icon">⛺</div><h3>車中泊・電装（FFヒーター等）</h3></div><p>目安180–360分｜参考 ¥25,000〜｜サブバッテリー・配電盤</p></div></div>
      </div>
    </div>
  </section>

  <!-- エリア判定 -->
  <section id="area">
    <div class="container">
      <div class="section-head">
        <div><h2>出張エリア判定と出張費の目安</h2><p>拠点からの距離をもとに概算します。正式なお見積りで確定します。</p></div>
        <a class="btn small" href="#booking">予約に進む</a>
      </div>
      <div class="calc">
        <div class="card">
          <div class="input">
            <label for="distance">拠点からの距離（km）</label>
            <input id="distance" type="number" min="0" step="1" placeholder="例：12">
            <label for="highway">高速道路の利用</label>
            <select id="highway"><option value="no">なし</option><option value="yes">あり（実費）</option></select>
            <label for="parking">駐車場の状況</label>
            <select id="parking"><option value="free">無料あり</option><option value="coin">コインP（実費）</option><option value="none">停めづらい（ご相談）</option></select>
            <button class="btn primary" id="calcBtn">概算を表示</button>
            <div class="help">目安：無料エリアは半径10km。10km超は10kmあたり¥1,000加算。</div>
          </div>
        </div>
        <div class="card" id="calcResult">
          <h3>概算結果</h3>
          <p id="areaLabel" style="margin:8px 0; color:#cbd5e1;">距離を入力すると自動計算します。</p>
          <div class="price">
            <div class="price-card"><div class="price-title">出張費</div><div class="price-num" id="fee">¥0</div><div class="price-note">距離・高速・駐車の実費を含みます</div></div>
            <div class="price-card"><div class="price-title">作業時間帯</div><div class="price-num" id="slot">午前／午後／夕方</div><div class="price-note">到着15分前にSMS/LINEでお知らせ</div></div>
            <div class="price-card"><div class="price-title">天候ポリシー</div><div class="price-num">無料振替</div><div class="price-note">警報級の悪天候は無料で振替します</div></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- 価格 -->
  <section id="pricing">
    <div class="container">
      <div class="section-head">
        <div><h2>出張専用パッケージ</h2><p>養生・動作テスト・施工保証を含みます。部材費は別途です。</p></div>
        <a class="btn small" href="#booking">写真で簡単見積り</a>
      </div>
      <div class="price">
        <div class="price-card"><div class="price-title">ドラレコ（前後）</div><div class="price-num">¥12,000〜</div><div class="price-note">目安90–120分｜駐車監視ハード配線対応</div></div>
        <div class="price-card"><div class="price-title">カーナビ</div><div class="price-num">¥28,000〜</div><div class="price-note">目安180–240分｜フェイス加工・CAN対応</div></div>
        <div class="price-card"><div class="price-title">オーディオ・スピーカー</div><div class="price-num">¥18,000〜</div><div class="price-note">目安120–240分｜DSP・デッドニング</div></div>
      </div>
      <p class="help">輸入車・特殊作業は別途お見積り。写真で事前確認いたします。</p>
    </div>
  </section>

  <!-- 予約 -->
  <section id="booking">
    <div class="container">
      <div class="section-head"><div><h2>予約・見積もり（ステップ式）</h2><p>最短日程と概算をお知らせします。写真添付で精度UP。</p></div></div>
      <div class="wizard">
        <div class="steps" id="steps"></div>
        <div class="wiz-pane active" data-step="1">
          <h3>1. 作業場所</h3>
          <div class="input">
            <label>都道府県</label>
            <select id="pref"><option value="">選択してください</option><option>東京都</option><option>神奈川県</option><option>千葉県</option><option>埼玉県</option><option>その他</option></select>
            <label>住所（市区町村・番地）</label><input id="addr" placeholder="例：〇〇市〇〇区〇〇 1-2-3">
            <label>駐車スペース</label><select id="space"><option>自宅ガレージ</option><option>月極駐車場</option><option>コインパーキング</option><option>職場駐車場</option></select>
          </div>
        </div>
        <div class="wiz-pane" data-step="2">
          <h3>2. 車両情報</h3>
          <div class="input">
            <label>メーカー</label><input id="brand" placeholder="例：Mercedes-Benz / Toyota">
            <label>車種・年式</label><input id="model" placeholder="例：Cクラス（2019）">
            <label>車検証の型式（任意）</label><input id="vin" placeholder="例：3BA-xxxx">
          </div>
        </div>
        <div class="wiz-pane" data-step="3">
          <h3>3. 作業内容</h3>
          <div class="input">
            <label>カテゴリ</label>
            <select id="job"><option>ドラレコ（前後）</option><option>ドラレコ（360°）</option><option>カーナビ</option><option>オーディオ・スピーカー</option><option>セキュリティ・トラッカー</option><option>ライト・LED・センサー</option><option>車中泊・電装</option></select>
            <label>詳細（任意）</label><textarea id="detail" rows="3" placeholder="型番・希望位置・連携希望など"></textarea>
          </div>
        </div>
        <div class="wiz-pane" data-step="4">
          <h3>4. 希望日時</h3>
          <div class="input">
            <label>日付</label><input id="date" type="date">
            <label>到着時間帯</label><select id="slotSel"><option>午前（9–12）</option><option>午後（13–16）</option><option>夕方（16–19）</option></select>
          </div>
        </div>
        <div class="wiz-pane" data-step="5">
          <h3>5. 写真アップロード（任意）</h3>
          <div class="input">
            <label>ダッシュ周り・ミラー周りなど（最大4枚）</label>
            <input id="photos" type="file" accept="image/*" multiple>
            <div id="thumbs" style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px;"></div>
            <p class="help">ナンバー周り、ヒューズボックス、駐車スペースがあると精度が上がります。</p>
          </div>
        </div>
        <div class="wiz-pane" data-step="6">
          <h3>6. 連絡先</h3>
          <div class="input">
            <label>お名前</label><input id="name" placeholder="例：山田 太郎">
            <label>電話番号</label><input id="phone" placeholder="例：090-1234-5678">
            <label>メールアドレス</label><input id="email" type="email" placeholder="例：you@example.com">
          </div>
          <p class="help">送信後、概算と最短日程をメール/SMSでご案内します。</p>
        </div>
        <div class="wiz-actions">
          <button class="btn ghost" id="prevBtn">戻る</button>
          <div style="display:flex;gap:8px;">
            <button class="btn" id="saveBtn">概算を表示</button>
            <button class="btn primary" id="submitBtn">予約を送信</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section id="faq">
    <div class="container">
      <div class="section-head"><div><h2>よくある質問</h2><p>不安な点はお気軽にお問い合わせください。</p></div></div>
      <div class="grid faq">
        <div class="col-6"><details class="q"><summary>雨天でも施工できますか？</summary><p>簡易テントと養生で対応します。警報級の悪天候は無料で振替いたします。</p></details></div>
        <div class="col-6"><details class="q"><summary>電源がない場所でも大丈夫？</summary><p>ポータブル電源を持参しますので問題ありません。</p></details></div>
        <div class="col-6"><details class="q"><summary>ディーラー保証に影響はありますか？</summary><p>正規コネクタ・保護処理で対応します。必要に応じて純正同等品のご提案も可能です。</p></details></div>
        <div class="col-6"><details class="q"><summary>支払い方法は？</summary><p>現地でカード・交通系・QR決済対応。法人様は請求書払いも可能です。</p></details></div>
      </div>
    </div>
  </section>
</main>

<footer>
  <div class="container">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;">
      <div>© 2025 出張取り付けサービス｜純正風の美しい施工</div>
      <div style="display:flex;gap:10px;">
        <a href="#booking">予約</a>・<a href="#area">エリア</a>・<a href="#faq">FAQ</a>
      </div>
    </div>
    <!-- 目立たない管理者リンク -->
    <div class="admin-link" id="adminLink" title="運営者向け">運営者</div>
  </div>
</footer>

<!-- スマホ固定ナビ -->
<div class="mobile-nav">
  <a class="btn" href="#services">サービス</a>
  <a class="btn" href="#area">エリア</a>
  <a class="btn primary" href="#booking">予約</a>
</div>

<!-- 管理者ログインモーダル -->
<div class="modal-backdrop" id="loginBackdrop" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="loginTitle">
    <h3 id="loginTitle">管理者ログイン</h3>
    <div class="row">
      <label>アカウント名</label>
      <input id="loginUser" autocomplete="username" placeholder="例：admin">
      <label>パスワード</label>
      <input id="loginPass" type="password" autocomplete="current-password" placeholder="••••••••">
    </div>
    <div class="modal-small">管理者のみご利用ください。入力後、ログインを押してください。</div>
    <div class="modal-actions">
      <button class="btn" id="loginCancel">キャンセル</button>
      <button class="btn primary" id="loginSubmit">ログイン</button>
    </div>
  </div>
</div>

<script>
  // ====== 設定（差し替え必須） ======
  const SCRIPT_URL = 'https://script.google.com/macros/s/YOUR_DEPLOY_ID/exec'; // AdminAPIのWebアプリURL
  const ADMIN_PAGE_URL = 'admin.html'; // 管理者ページのパス（同一ドメイン内想定）
  // ==================================

  // エリア判定＆出張費概算
  const calcBtn = document.getElementById('calcBtn');
  const distanceEl = document.getElementById('distance');
  const highwayEl = document.getElementById('highway');
  const parkingEl = document.getElementById('parking');
  const feeEl = document.getElementById('fee');
  const areaLabelEl = document.getElementById('areaLabel');
  const slotEl = document.getElementById('slot');
  let latestFee = 0, latestDistance = 0, latestHighway = 'なし', latestParking = '無料あり';

  function formatJPY(n) { return '¥' + (Math.round(n)).toLocaleString('ja-JP'); }
  calcBtn?.addEventListener('click', () => {
    const d = parseFloat(distanceEl.value || '0');
    const baseFree = 10, step = 10, perStepFee = 1000;
    let fee = 0;
    if (d > baseFree) { const over = d - baseFree; const steps = Math.ceil(over / step); fee += steps * perStepFee; }
    if (highwayEl.value === 'yes') fee += 800;
    if (parkingEl.value === 'coin') fee += 600;
    latestFee = fee; latestDistance = d; latestHighway = highwayEl.value === 'yes' ? 'あり' : 'なし'; latestParking = parkingEl.value;
    feeEl.textContent = formatJPY(fee);
    areaLabelEl.textContent = d <= baseFree ? '無料エリア内です' : `半径${baseFree}km超：距離加算あり`;
    slotEl.textContent = '午前／午後／夕方';
  });

  // 予約ウィザード（既存の簡易概算＆送信デモ）
  const panes = Array.from(document.querySelectorAll('.wiz-pane'));
  const prevBtn = document.getElementById('prevBtn');
  const submitBtn = document.getElementById('submitBtn');
  const saveBtn = document.getElementById('saveBtn');
  const stepsBar = document.getElementById('steps');
  let step = 1;
  function renderSteps() { stepsBar.innerHTML = ''; for (let i=1;i<=panes.length;i++){ const dot=document.createElement('div'); dot.className='step-dot'+(i<=step?' active':''); stepsBar.appendChild(dot);} }
  function showStep(n) { step=Math.max(1,Math.min(n,panes.length)); panes.forEach(p=>p.classList.toggle('active',parseInt(p.dataset.step)===step)); renderSteps(); prevBtn.disabled=step===1; submitBtn.textContent=step===panes.length?'予約を送信':'次へ'; }
  prevBtn?.addEventListener('click', () => showStep(step - 1));
  saveBtn?.addEventListener('click', () => {
    const job = document.getElementById('job').value;
    const jobMap = { 'ドラレコ（前後）':{time:'90–120分',price:12000}, 'ドラレコ（360°)':{time:'90–120分',price:14000}, 'カーナビ':{time:'180–240分',price:28000}, 'オーディオ・スピーカー':{time:'120–240分',price:18000}, 'セキュリティ・トラッカー':{time:'120–180分',price:22000}, 'ライト・LED・センサー':{time:'60–120分',price:9000}, '車中泊・電装':{time:'180–360分',price:25000} };
    const info = jobMap[job] || { time:'—', price:0 };
    alert(`概算：${job}｜所要 ${info.time}｜出張費はエリアで加算\n参考価格：${formatJPY(info.price)}〜`);
  });
  const photos = document.getElementById('photos'); const thumbs = document.getElementById('thumbs');
  photos?.addEventListener('change', (e) => { thumbs.innerHTML=''; const files=Array.from(e.target.files||[]).slice(0,4); files.forEach(file=>{ const reader=new FileReader(); reader.onload=()=>{ const img=document.createElement('img'); img.src=reader.result; img.style.width='96px'; img.style.height='72px'; img.style.objectFit='cover'; img.style.borderRadius='8px'; img.style.border='1px solid rgba(255,255,255,0.12)'; thumbs.appendChild(img); }; reader.readAsDataURL(file); }); });
  submitBtn?.addEventListener('click', async () => {
    if (step < panes.length) { showStep(step + 1); return; }
    alert('予約デモ送信：本番ではApps ScriptへPOSTしてください。');
  });
  showStep(1); renderSteps();

  // 管理者リンク（目立たない）
  const adminLink = document.getElementById('adminLink');
  const backdrop = document.getElementById('loginBackdrop');
  const loginUser = document.getElementById('loginUser');
  const loginPass = document.getElementById('loginPass');
  const loginCancel = document.getElementById('loginCancel');
  const loginSubmit = document.getElementById('loginSubmit');

  adminLink.addEventListener('click', () => {
    backdrop.classList.add('show');
    loginUser.focus();
  });
  loginCancel.addEventListener('click', () => {
    backdrop.classList.remove('show');
    loginUser.value = ''; loginPass.value = '';
  });
  loginSubmit.addEventListener('click', async () => {
    const u = (loginUser.value || '').trim();
    const p = loginPass.value || '';
    if (!u || !p) { alert('アカウント名とパスワードを入力してください'); return; }
    try {
      const res = await fetch(SCRIPT_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ action: 'login', username: u, password: p })
      });
      const json = await res.json();
      if (json && json.ok && json.token) {
        // トークンをセッションに保存して管理ページへ
        sessionStorage.setItem('admin_token', json.token);
        backdrop.classList.remove('show');
        loginUser.value = ''; loginPass.value = '';
        // 管理ページへ控えめに遷移（クエリにも付与）
        location.href = `${ADMIN_PAGE_URL}?token=${encodeURIComponent(json.token)}`;
      } else {
        alert('ログインに失敗しました。アカウント名またはパスワードをご確認ください。');
      }
    } catch (e) {
      alert('ネットワークエラー：ログインできませんでした。');
    }
  });

  // キーボードショートカット（控えめ）：Ctrl+Shift+A でも開く
  document.addEventListener('keydown', (e) => {
    if (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === 'a') {
      backdrop.classList.add('show');
      loginUser.focus();
    }
  });
</script>
</body>
</html>
```
